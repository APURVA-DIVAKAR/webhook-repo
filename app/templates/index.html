<!DOCTYPE html>
<html>
<head>
  <title>GitHub Events</title>
  <style>
    body {
      background: #0f172a;
      color: #e5e7eb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      padding: 24px;
    }

    h2 {
      text-align: center;
      margin-bottom: 16px;
      font-weight: 600;
      color: #f9fafb;
    }

    #events {
      max-width: 70%;
      margin: auto;
    }

    .event {
      background: #020617;
      border-left: 4px solid #38bdf8;
      padding: 12px 14px;
      margin-bottom: 12px;
      border-radius: 6px;
    }

    .message {
      font-size: 14px;
      margin-bottom: 4px;
    }

    .time {
      font-size: 12px;
      color: #94a3b8;
    }
  </style>
</head>
<body>

<h2>ðŸš€ GitHub Activity</h2>
<div id="events"></div>

<script>
  // Getting data
  async function fetchEvents() {
    try {
      const res = await fetch("/events");
      const data = await res.json();

      const container = document.getElementById("events");
      container.innerHTML = "";

      data.forEach(e => {
        // Mapping the data on UI
        const div = document.createElement("div");
        div.className = "event";

        const msg = document.createElement("div");
        msg.className = "message";
        msg.innerText = e.message || "No Message";

        const time = document.createElement("div");
        time.className = "time";
        time.innerText = new Date(e.timestamp.$date).toLocaleString();

        div.appendChild(msg);
        div.appendChild(time);
        container.appendChild(div);
      });
    } catch (err) {
      const div = document.createElement("div");
      const errorMsg = document.createElement("h2");
      errorMsg.innerText = err;
      console.error("Fetch failed", err);
      div.appendChild(errorMsg)
    }
  }

  fetchEvents();

  // Setting interval to 15s and fetching
  setInterval(fetchEvents, 15000);
</script>

</body>
</html>
